<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Happy Eid Mubarak</title>
    <!-- Font Awesome for Icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
    
    <!-- Canvas Confetti Library -->
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.9.2/dist/confetti.browser.min.js"></script>
    
    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-6985722776441624" crossorigin="anonymous"></script>
    
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600&display=swap');

        :root {
            --primary-glow: #ffd700;
            --secondary-glow: #ff4500;
            --bg-gradient-start: #1a3c34;
            --bg-gradient-end: #0a1a15;
        }

        body {
            font-family: 'Poppins', sans-serif;
            text-align: center;
            background: linear-gradient(45deg, var(--bg-gradient-start), var(--bg-gradient-end));
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            margin: 0;
            padding: 20px 0;
            color: #fff;
            overflow-x: hidden;
            transition: background 1s ease;
        }

        .card {
            max-width: 90%;
            width: 500px;
            padding: 30px 40px;
            border-radius: 25px;
            box-sizing: border-box;
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
            backdrop-filter: blur(15px);
            box-shadow: 0 8px 32px 0 rgba(0, 0, 0, 0.37);
            transition: all 0.5s ease;
            z-index: 10; /* Ensure card is above confetti canvas */
        }
        
        #section1 { display: block; }
        #section2 { display: none; }

        header h1 {
            background: linear-gradient(90deg, #f39c12, #ff6b6b, #3498db);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            font-size: clamp(2em, 7vw, 2.8em);
            font-weight: 600;
            margin-bottom: 15px;
        }

        header h2 {
            font-size: clamp(1.2em, 4vw, 1.5em);
            font-weight: 400;
            background: linear-gradient(90deg, #ffd700, #ff7e5f);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        p {
            font-size: clamp(1em, 3vw, 1.1em);
            font-weight: 300;
            margin-bottom: 25px;
            line-height: 1.6;
        }

        #initialIcon {
            font-size: 4em;
            color: var(--primary-glow);
            text-shadow: 0 0 20px var(--primary-glow);
            animation: gentle-bob 3s ease-in-out infinite;
        }
        
        @keyframes gentle-bob {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-15px); }
        }

        input[type="text"] {
            padding: 15px;
            font-size: 1em;
            margin-bottom: 20px;
            border-radius: 50px;
            background: rgba(255, 255, 255, 0.9);
            color: #333;
            border: 2px solid transparent;
            width: 100%;
            max-width: 300px;
            box-sizing: border-box;
            text-align: center;
            outline: none;
            transition: all 0.3s ease;
        }
        input[type="text"]::placeholder { color: #888; }
        input[type="text"]:focus {
            border-color: var(--primary-glow);
            box-shadow: 0 0 15px var(--primary-glow);
        }

        .button-container {
             display: flex;
             justify-content: center;
             gap: 15px;
             flex-wrap: wrap;
        }

        button {
            padding: 12px 25px;
            font-size: 1.1em;
            border-radius: 50px;
            cursor: pointer;
            background: #4f8205;
            color: #fff;
            border: 2px solid greenyellow;
            transition: all 0.3s ease;
            display: inline-flex;
            align-items: center;
            gap: 10px;
        }
        button:hover {
            transform: translateY(-3px);
            box-shadow: 0 5px 20px rgba(172, 255, 47, 0.5);
        }
        button:hover .fa-solid { animation: fa-beat 1s infinite; }

        .decorated body {
            background: linear-gradient(45deg, #1a3c34, #ff4500, #ffd700, #00cc66);
            background-size: 400% 400%;
            animation: gradientBG 15s ease infinite;
        }
        @keyframes gradientBG {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }

        .decorated .card {
            border-color: transparent;
            animation: borderPulse 3s infinite;
        }
        @keyframes borderPulse {
            0%   { border-color: var(--primary-glow); box-shadow: 0 0 20px var(--primary-glow); }
            50%  { border-color: var(--secondary-glow); box-shadow: 0 0 30px var(--secondary-glow); }
            100% { border-color: var(--primary-glow); box-shadow: 0 0 20px var(--primary-glow); }
        }

        #wishText {
            text-shadow: 0 0 10px var(--primary-glow), 0 0 20px var(--secondary-glow);
            animation: glow 1.5s infinite alternate;
        }
        @keyframes glow {
            from { text-shadow: 0 0 8px var(--primary-glow), 0 0 15px var(--secondary-glow); }
            to   { text-shadow: 0 0 15px var(--primary-glow), 0 0 30px var(--secondary-glow); }
        }

        .create-own-wish-section {
            margin-top: 40px;
            padding-top: 25px;
            border-top: 1px solid rgba(255, 255, 255, 0.2);
        }
        .create-own-wish-section p {
            font-weight: 400;
            margin-bottom: 15px;
        }
    </style>
</head>
<body>

    <div id="section1" class="card">
        <div id="initialIcon"><i class="fa-solid fa-moon"></i></div>
        <p>Enter your name to create a personalized Eid wish to share with friends!</p>
        <input type="text" id="userNameInput" placeholder="Enter your name">
        <button onclick="goToWishesPage()">
            <i class="fa-solid fa-wand-magic-sparkles"></i> Create Wish
        </button>
    </div>

    <div id="section2" class="card">
        <header>
            <h1><i class="fa-solid fa-kaaba"></i> Eid Mubarak <i class="fa-solid fa-star-and-crescent"></i></h1>
            <h2 id="userNameHeader"></h2>
        </header>
        <main>
          <p id="wishText"></p>
          <div class="button-container">
              <button onclick="speakWish()" title="Read wish aloud"><i class="fa-solid fa-volume-high"></i></button>
              <button onclick="refreshWish()" title="Get a new wish"><i class="fa-solid fa-arrows-rotate"></i></button>
              <button onclick="shareWish()" title="Share with a friend"><i class="fa-solid fa-share-nodes"></i></button>
          </div>
        </main>
        
        <div class="create-own-wish-section">
            <p>Want to send your own Eid greeting?</p>
            <button onclick="redirectToHome()">
                <i class="fa-solid fa-pen-to-square"></i> Create Your Own
            </button>
        </div>
    </div>

    <!-- NEW: Audio element for the popper sound -->
    <audio id="popperSound" src="popper.mp3" preload="auto"></audio>

    <script>
        const wishes = [
            "May this Eid bring joy, peace, and prosperity to your life.",
            "Wishing you a blessed Eid filled with love, laughter, and happiness.",
            "May Allah's blessings grace your home with warmth and peace. Eid Mubarak!",
            "Eid Mubarak to you and your loved ones. May you be blessed today and always.",
            "Sending you warm wishes on this beautiful occasion. May it bring you peace.",
            "May the magic of this Eid bring endless happiness into your life.",
            "Eid is a day to cheer and laugh. Be grateful to Allah for all his blessings.",
            "Eid Mubarak! May all your dreams and hopes be fulfilled.",
            "May the divine blessings of Allah bring you hope, faith, and joy forever.",
            "Wishing you a joyful Eid. Remember me in your prayers."
        ];

        let senderName = '';
        let selectedVoice = null;

        function findBestMaleVoice() {
            speechSynthesis.onvoiceschanged = () => {
                const voices = speechSynthesis.getVoices();
                selectedVoice = voices.find(v => v.lang.includes('en-GB') && v.name.includes('Male')) || 
                                voices.find(v => v.lang.includes('en') && v.name.includes('Male')) ||
                                voices.find(v => v.lang.includes('en-US') && v.name.includes('David')) ||
                                voices.find(v => v.lang.includes('en'));
            };
        }
        
        // NEW: Function to launch confetti
        function launchConfetti() {
            // Play the sound effect
            document.getElementById('popperSound').play().catch(e => console.error("Sound play failed:", e));

            // Define some options for the confetti poppers
            const popperOptions = {
                angle: 270,
                spread: 120,
                particleCount: 100,
                origin: { y: 0.6 },
                colors: ['#ffd700', '#ff4500', '#ff6b81', '#ffffff']
            };

            // Launch multiple bursts for a better effect
            confetti({ ...popperOptions, origin: { x: 0.1, y: 1 } });
            setTimeout(() => { confetti({ ...popperOptions, origin: { x: 0.9, y: 1 } }); }, 150);
            setTimeout(() => { confetti({ particleCount: 150, spread: 360, origin: { x: 0.5, y: 0.5 } }); }, 300);
        }

        function goToWishesPage() {
            if (!senderName) {
                senderName = document.getElementById('userNameInput').value.trim();
            }
            
            // Launch celebration effects!
            launchConfetti();

            // Hide section 1 and show section 2
            document.getElementById('section1').style.display = 'none';
            document.getElementById('section2').style.display = 'block';
            document.body.classList.add('decorated');
            document.getElementById('userNameHeader').textContent = `From ${senderName || 'A Friend'} to You!`;
            refreshWish();
        }

        function refreshWish() {
            const randomWish = wishes[Math.floor(Math.random() * wishes.length)];
            const displayName = senderName || "A friend";
            document.getElementById('wishText').textContent = `${displayName} wishes you: "${randomWish}"`;
        }
        
        function speakWish() {
            if (window.speechSynthesis.speaking) return;
            const wishText = document.getElementById('wishText').textContent;
            if ('speechSynthesis' in window) {
                const speech = new SpeechSynthesisUtterance(wishText);
                speech.voice = selectedVoice;
                speech.pitch = 0.9;
                speech.rate = 1;
                window.speechSynthesis.speak(speech);
            } else {
                alert("Sorry, your browser doesn't support text-to-speech.");
            }
        }
        
        async function shareWish() {
            const displayName = senderName || 'A friend';
            const shareUrl = `${window.location.origin}${window.location.pathname}?name=${encodeURIComponent(displayName)}`;
            const shareText = `${displayName} is wishing you a Happy Eid Mubarak! âœ¨ Check out your personalized wish:`;
            const shareData = { title: 'Eid Mubarak Wishes!', text: shareText, url: shareUrl };

            if (navigator.share) {
                await navigator.share(shareData).catch(err => console.error('Share failed:', err));
            } else {
                navigator.clipboard.writeText(`${shareText} ${shareUrl}`).then(() => {
                    alert("Link copied to clipboard! You can now paste it to share.");
                });
            }
        }
        
        function redirectToHome() {
            window.location.href = window.location.origin + window.location.pathname;
        }

        window.onload = () => {
            findBestMaleVoice();
            const urlParams = new URLSearchParams(window.location.search);
            const nameFromUrl = urlParams.get("name");

            if (nameFromUrl) {
                senderName = decodeURIComponent(nameFromUrl);
                goToWishesPage();
            }
        };
    </script>
</body>
</html>